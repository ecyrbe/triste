{"version":3,"sources":["components/board.module.css","hooks/tetrominos.ts","utils/classnames.ts","utils/range.ts","components/board.tsx","hooks/keyboard.ts","hooks/interval.ts","App.tsx","serviceWorker.ts","index.tsx"],"names":["module","exports","tetrominos","shapes","I","J","L","O","S","T","Z","positions","x","y","getInitBoard","width","height","Array","fill","map","line","getRandomTetromino","Math","floor","random","length","isInShape","shape","posX","posY","isShapeCollidingWithBoard","board","some","j","value","i","mergeBoard","prev","lines","cur","l","filter","splice","cn","names","join","range","start","end","from","_","TetrominoStyles","Cell","React","memo","className","style","square","internSquare","Board","props","useState","setBoard","currentTetromino","setCurrent","nextTetromino","setNext","setX","setY","setShape","isInCurrentShape","useCallback","next","rotate","nextShape","zip","reverse","left","right","down","prevBoard","useTetris","useMemo","callback","codes","options","keydown","keyup","cb","useRef","useEffect","current","downHandler","event","includes","code","upHandler","window","addEventListener","removeEventListener","useKeyBoard","preventDefault","delay","id","setInterval","clearInterval","useInterval","key","blockLine","App","Boolean","location","hostname","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","console","message"],"mappings":"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","file":"static/js/main.8c48c2b1.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"board\":\"board_board__5xYAb\",\"lines\":\"board_lines__K2aWm\",\"blockLine\":\"board_blockLine__2Shsx\",\"next\":\"board_next__zhgk4\",\"square\":\"board_square__19hXC\",\"none\":\"board_none__25BgY\",\"one\":\"board_one__2ke9C\",\"two\":\"board_two__1RWiR\",\"three\":\"board_three__1pjLR\",\"four\":\"board_four__GV_vy\",\"five\":\"board_five__1mnPE\",\"six\":\"board_six__2Ur0s\",\"seven\":\"board_seven__2Vm-w\",\"internSquare\":\"board_internSquare__3Bn7h\"};","import { useState, useCallback } from \"react\";\nimport zip from \"lodash.zip\";\n\nconst tetrominos = [\"I\", \"J\", \"L\", \"O\", \"S\", \"T\", \"Z\"] as const;\n\nconst shapes = {\n  I: [[1, 1, 1, 1]],\n  J: [\n    [2, 0, 0],\n    [2, 2, 2],\n  ],\n  L: [\n    [0, 0, 3],\n    [3, 3, 3],\n  ],\n  O: [\n    [4, 4],\n    [4, 4],\n  ],\n  S: [\n    [0, 5, 5],\n    [5, 5, 0],\n  ],\n  T: [\n    [0, 6, 0],\n    [6, 6, 6],\n  ],\n  Z: [\n    [7, 7, 0],\n    [0, 7, 7],\n  ],\n};\n\nconst positions = {\n  I: { x: 3, y: -1 },\n  J: { x: 3, y: -1 },\n  L: { x: 3, y: -1 },\n  O: { x: 4, y: -1 },\n  S: { x: 3, y: -1 },\n  T: { x: 3, y: -1 },\n  Z: { x: 3, y: -1 },\n};\nexport type Tetromino = typeof tetrominos[number];\n\nfunction getInitBoard(width: number, height: number) {\n  return new Array<Array<number>>(height)\n    .fill(new Array<number>(width))\n    .map((line) => line.fill(0));\n}\n\nfunction getRandomTetromino() {\n  return tetrominos[Math.floor(Math.random() * Math.floor(tetrominos.length))];\n}\n\n/**\n * get the shape of the given tetromino\n * @param t a tetromino\n */\nexport function getTetrominoShape(t: Tetromino) {\n  return shapes[t];\n}\n\n/**\n * check if a given point from the board is in a given shape\n * @param shape the shape to check a position against\n * @param posX horizontal position of the shape in the board\n * @param posY vertical position of the shape in the board\n * @param x horizontal position in the board to check\n * @param y vertical position in the board to check\n */\nexport function isInShape(\n  shape: number[][],\n  posX: number,\n  posY: number,\n  x: number,\n  y: number\n) {\n  return x >= posX &&\n    x < posX + shape[0].length &&\n    y >= posY &&\n    y < posY + shape.length\n    ? shape[y - posY][x - posX]\n    : 0;\n}\n\nfunction isShapeCollidingWithBoard(\n  board: number[][],\n  shape: number[][],\n  x: number,\n  y: number\n) {\n  return (\n    x < 0 ||\n    shape.some(\n      (line, j) =>\n        y + j >= board.length ||\n        line.some(\n          (value, i) =>\n            value > 0 &&\n            (x + i < board[0].length\n              ? y + j >= 0\n                ? board[y + j][x + i] + value > value\n                : false\n              : true)\n        )\n    )\n  );\n}\n\nfunction mergeBoard(prev: number[][], shape: number[][], x: number, y: number) {\n  const lines = prev.length;\n  const cur = prev\n    .map((line, l) =>\n      line.map((value, i) => value + isInShape(shape, x, y, i, l))\n    )\n    .filter((line) => line.some((value) => value === 0));\n  cur.splice(0, 0, ...getInitBoard(prev[0].length, lines - cur.length));\n  return cur;\n}\n\n/**\n * create a full tetris game state\n * @param width width of tetris\n * @param height height of tetris\n */\nexport const useTetris = (width = 10, height = 20) => {\n  const [board, setBoard] = useState(() => getInitBoard(width, height));\n  const [currentTetromino, setCurrent] = useState(getRandomTetromino);\n  const [nextTetromino, setNext] = useState(getRandomTetromino);\n  const [posX, setX] = useState(positions[currentTetromino].x);\n  const [posY, setY] = useState(positions[currentTetromino].y);\n  const [shape, setShape] = useState<number[][]>(shapes[currentTetromino]);\n\n  const isInCurrentShape = useCallback(\n    (x: number, y: number) => isInShape(shape, posX, posY, x, y),\n    [posX, posY, shape]\n  );\n  const next = useCallback(() => {\n    setShape(shapes[nextTetromino]);\n    setX(positions[nextTetromino].x);\n    setY(positions[nextTetromino].y);\n    setCurrent(nextTetromino);\n    setNext(getRandomTetromino());\n  }, [nextTetromino]);\n\n  const rotate = useCallback(() => {\n    const nextShape = zip(...shape).reverse() as number[][];\n    if (!isShapeCollidingWithBoard(board, nextShape, posX, posY))\n      setShape(nextShape);\n  }, [board, shape, posX, posY]);\n  const left = useCallback(\n    () =>\n      setX((prev) =>\n        isShapeCollidingWithBoard(board, shape, prev - 1, posY)\n          ? prev\n          : prev - 1\n      ),\n    [board, shape, posY]\n  );\n  const right = useCallback(\n    () =>\n      setX((prev) =>\n        isShapeCollidingWithBoard(board, shape, prev + 1, posY)\n          ? prev\n          : prev + 1\n      ),\n    [board, shape, posY]\n  );\n  const down = useCallback(\n    () =>\n      setY((prev) => {\n        if (isShapeCollidingWithBoard(board, shape, posX, prev + 1)) {\n          setBoard((prevBoard) => mergeBoard(prevBoard, shape, posX, prev));\n          next();\n          return prev;\n        } else return prev + 1;\n      }),\n    [board, shape, posX, next]\n  );\n  return {\n    board,\n    currentTetromino,\n    nextTetromino,\n    isInCurrentShape,\n    next,\n    rotate,\n    left,\n    right,\n    down,\n  };\n};\n","export const cn = (...names: string[]) => names.join(\" \");\n","export const range = (start: number, end: number, length = end - start + 1) =>\n  Array.from({ length }, (_, i) => start + i);\n","import React, { useMemo } from \"react\";\nimport { useTetris, getTetrominoShape, isInShape } from \"../hooks/tetrominos\";\nimport { useInterval } from \"../hooks/interval\";\nimport { useKeyBoard } from \"../hooks/keyboard\";\nimport { cn, range } from \"../utils\";\n\nimport style from \"./board.module.css\";\n\ntype BoardProps = {\n  width: number;\n  height: number;\n};\n\nconst TetrominoStyles = [\n  \"none\",\n  \"one\",\n  \"two\",\n  \"three\",\n  \"four\",\n  \"five\",\n  \"six\",\n  \"seven\",\n] as const;\n\nfunction Square({ value }: { value: number }) {\n  return (\n    <div className={cn(style.square, style[TetrominoStyles[value]])}>\n      <div className={cn(style.internSquare, style[TetrominoStyles[value]])} />\n    </div>\n  );\n}\n\nconst Cell = React.memo(Square);\n\nexport function Board(props: BoardProps) {\n  const {\n    board,\n    nextTetromino,\n    isInCurrentShape,\n    rotate,\n    down,\n    left,\n    right,\n    next,\n  } = useTetris(props.width, props.height);\n\n  const nextShape = useMemo(() => getTetrominoShape(nextTetromino), [\n    nextTetromino,\n  ]);\n\n  useKeyBoard(\n    (event) => {\n      switch (event.code) {\n        case \"ArrowUp\":\n          rotate();\n          break;\n        case \"ArrowDown\":\n          down();\n          break;\n        case \"ArrowLeft\":\n          left();\n          break;\n        case \"ArrowRight\":\n          right();\n          break;\n        case \"Space\":\n          next();\n          break;\n      }\n      event.preventDefault();\n    },\n    [\"ArrowUp\", \"ArrowDown\", \"ArrowLeft\", \"ArrowRight\", \"Space\"]\n  );\n  useInterval(down, 1000);\n\n  return (\n    <div className={cn(style.board)}>\n      <div className={cn(style.lines)}>\n        {board.map((line, l) => (\n          <div key={l} className={cn(style.blockLine)}>\n            {line.map((value, i) => (\n              <Cell value={value || isInCurrentShape(i, l)} />\n            ))}\n          </div>\n        ))}\n      </div>\n      <div className={cn(style.next)}>\n        Next Block\n        <div className={cn(style.lines)}>\n          {range(1, 4).map((y) => (\n            <div key={y} className={cn(style.blockLine)}>\n              {range(1, 6).map((x) => (\n                <Cell value={isInShape(nextShape, 2, 2, x, y)} />\n              ))}\n            </div>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}\n","import { useEffect, useRef } from \"react\";\n\nexport function useKeyBoard(\n  callback: (event: KeyboardEvent) => void,\n  codes: string[],\n  options: {\n    keyup?: boolean;\n    keydown?: boolean;\n  } = { keydown: true, keyup: false }\n) {\n  const cb = useRef(callback);\n\n  useEffect(() => {\n    cb.current = callback;\n  }, [callback]);\n\n  useEffect(() => {\n    const downHandler = (event: KeyboardEvent) => {\n      if (codes.includes(event.code)) {\n        cb.current(event);\n      }\n    };\n    const upHandler = (event: KeyboardEvent) => {\n      if (codes.includes(event.code)) {\n        cb.current(event);\n      }\n    };\n    if (options.keydown) window.addEventListener(\"keydown\", downHandler);\n    if (options.keyup) window.addEventListener(\"keyup\", upHandler);\n    return () => {\n      window.removeEventListener(\"keydown\", downHandler);\n      window.removeEventListener(\"keyup\", upHandler);\n    };\n  }, [cb, codes, options.keyup, options.keydown]);\n}\n","import { useEffect, useRef } from \"react\";\n\nexport function useInterval(callback: () => void, delay: number) {\n  const cb = useRef(callback);\n\n  useEffect(() => {\n    cb.current = callback;\n  }, [callback]);\n\n  useEffect(() => {\n    const tick = () => cb.current();\n    const id = setInterval(tick, delay);\n    return () => clearInterval(id);\n  }, [cb, delay]);\n}\n","import React from \"react\";\nimport \"./App.css\";\nimport { Board } from \"./components/board\";\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <Board width={10} height={20} />\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}